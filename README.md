# Проект Распознавания Азбуки Морзе

Этот проект содержит код для обучения и оценки модели глубокого обучения (CRNN) для распознавания аудиозаписей азбуки Морзе.

## Структура Проекта

- `config/`: Конфигурационные файлы.
  - `config.py`: Основные параметры эксперимента (пути, гиперпараметры, настройки аудио и т.д.).
- `data/`: Модули для работы с данными.
  - `dataset.py`: Класс `MorseDataset` для загрузки и предобработки аудио.
  - `preprocessing.py`: Функции для аугментации и предобработки аудио/спектрограмм.
  - `collate.py`: Функции `collate_fn` для формирования батчей.
- `models/`: Определения моделей.
  - `crnn.py`: Класс модели `CRNNModel_4Layer`.
- `utils/`: Вспомогательные утилиты.
  - `decoding.py`: Функции для CTC-декодирования (Greedy).
  - `metrics.py`: Функции для расчета метрик (Levenshtein, CER).
  - `helpers.py`: Вспомогательные функции (установка seed, проверка зависимостей).
- `scripts/`: Исполняемые скрипты.
  - `train.py`: Запуск процесса обучения модели.
  - `predict.py`: Запуск инференса на тестовых данных и создание файла `submission.csv`.
- `notebooks/`: Jupyter ноутбуки для анализа и визуализации.
  - `results_analysis.ipynb`: Анализ логов обучения, оценка лучшей модели, построение графиков и confusion matrix.
- `requirements.txt`: Список необходимых Python библиотек.
- `.gitignore`: Файл для исключения ненужных файлов из Git.
- `README.md`: Этот файл.

## Установка

1.  Клонируйте репозиторий:
    ```bash
    git clone [<your-repo-url>](https://github.com/DinoZawrik/MorseDecoder.git)
    cd morse_code_project
    ```
2.  Создайте и активируйте виртуальное окружение (рекомендуется):
    ```bash
    python -m venv venv
    source venv/bin/activate  # Linux/macOS
    # venv\Scripts\activate  # Windows
    ```
3.  Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```
4.  (Опционально) Для использования Beam Search установите `flashlight-text`:
    ```bash
    pip install flashlight-text --no-deps
    ```
5.  **Данные:** Убедитесь, что данные (train.csv, test.csv, sample_submission.csv, папка с аудио) доступны по путям, указанным в `config/config.py` (параметры `KAGGLE_INPUT_DIR`). При необходимости измените пути.

## Использование

### Обучение Модели

1.  Настройте параметры в `config/config.py` (имя модели, гиперпараметры, аугментации и т.д.).
2.  Запустите скрипт обучения:
    ```bash
    python scripts/train.py
    ```
    - Логи обучения будут сохранены в файл, указанный в `config.LOG_FILE`.
    - Чекпоинты модели будут сохранены в папку, указанную в `config.CHECKPOINT_DIR`. Лучшая модель сохраняется как `*_best.pth`.
    - Графики обучения будут сохранены в папку `logs/`.

### Инференс и Создание Submission

1.  Убедитесь, что лучший чекпоинт (`*_best.pth`) существует в папке `config.CHECKPOINT_DIR`.
2.  Запустите скрипт инференса:
    ```bash
    python scripts/predict.py
    ```
    - Скрипт автоматически найдет лучший чекпоинт (или можно указать путь через аргумент `--checkpoint`).
    - Он загрузит модель, тестовые данные, выполнит предсказания (используя Greedy или Beam Search, в зависимости от `config.INFERENCE['use_beam_search']` и наличия `flashlight-text`).
    - Итоговый файл `submission.csv` будет сохранен в папке `config.KAGGLE_WORKING_DIR`.

### Анализ Результатов

1.  Запустите Jupyter Notebook `notebooks/results_analysis.ipynb`.
2.  Ноутбук загрузит лог обучения (`config.LOG_FILE`) и лучший чекпоинт, построит кривые обучения, оценит модель на валидационной выборке и отобразит Confusion Matrix.

## Замечания

- Конфигурация предобработки и параметры модели для инференса и анализа загружаются из сохраненного чекпоинта, чтобы обеспечить консистентность.
- Убедитесь, что версии `torch` и `torchaudio` совместимы.